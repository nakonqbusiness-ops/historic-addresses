<!doctype html>
<html lang="bg" data-theme="dark">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" type="image/x-icon" href="/assets/img/HistAdrLogoOrig2.ico">
<link rel="icon" type="image/png" sizes="192x192" href="/assets/img/Historyaddress.bg2.png">
<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/apple-touch-icon.png">
    <title>–ö–∞–ª–µ–Ω–¥–∞—Ä - –ê–¥—Ä–µ—Å—ä—Ç –Ω–∞ –∏—Å—Ç–æ—Ä–∏—è—Ç–∞</title>
    <meta name="description" content="–í–∏–∂—Ç–µ —Ä–æ–∂–¥–µ–Ω–∏ –¥–Ω–∏ –∏ –≥–æ–¥–∏—à–Ω–∏–Ω–∏ –æ—Ç –∂–∏–≤–æ—Ç–∞ –Ω–∞ –∑–Ω–∞—á–∏–º–∏ –±—ä–ª–≥–∞—Ä—Å–∫–∏ –ª–∏—á–Ω–æ—Å—Ç–∏.">
    <script>
        (function() {
            try {
                var stored = localStorage.getItem('theme-preference');
                if (stored === 'system') stored = 'dark';
                var theme = (stored === 'dark' || stored === 'light') ? stored : 'dark';
                document.documentElement.setAttribute('data-theme', theme);
            } catch(e) {}
        })();
    </script>
    <link rel="stylesheet" href="assets/css/styles.css">
    <script defer src="assets/js/theme.js"></script>
    <script defer src="assets/js/transitions.js"></script>
    <script defer src="assets/js/calendar-popup.js"></script>
    <style>
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }
        .calendar-nav {
            display: flex;
            gap: 1rem;
            align-items: center;
        }
        .calendar-nav button {
            min-width: 44px;
            padding: 0.75rem 1rem;
        }
        .calendar-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--fg);
        }
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
            margin-bottom: 2rem;
            width: 100%;
        }
        .calendar-day-header {
            text-align: center;
            padding: 1rem 0.5rem;
            font-weight: 700;
            color: var(--muted);
            font-size: 0.85rem;
            text-transform: uppercase;
        }
        .calendar-day {
            aspect-ratio: 1;
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 0.5rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            position: relative;
            cursor: default;
            transition: all 0.3s ease;
            min-height: 80px;
        }
        .calendar-day.other-month {
            opacity: 0.3;
        }
        .calendar-day.today {
            border: 2px solid var(--accent-strong);
            box-shadow: 0 0 20px rgba(205, 133, 63, 0.3);
        }
        .calendar-day.has-events {
            cursor: pointer;
            background: rgba(205, 133, 63, 0.1);
        }
        .calendar-day.has-events:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-soft);
            background: rgba(205, 133, 63, 0.2);
        }
        .calendar-day-number {
            font-weight: 700;
            font-size: 1.1rem;
            margin-bottom: 0.25rem;
            color: var(--fg);
        }
        .calendar-events-indicator {
            display: flex;
            gap: 4px;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 0.25rem;
        }
        .event-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: var(--accent-strong);
        }
        .event-dot.birth {
            background: #4CAF50;
        }
        .event-dot.death {
            background: #9E9E9E;
        }
        .events-list {
            margin-top: 2rem;
        }
        .event-card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            display: flex;
            gap: 1rem;
            align-items: center;
            transition: all 0.3s ease;
            cursor: pointer;
            text-decoration: none;
            color: inherit;
        }
        .event-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-soft);
        }
        .event-icon {
            font-size: 2rem;
            flex-shrink: 0;
        }
        .event-content {
            flex: 1;
        }
        .event-name {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--fg);
            margin-bottom: 0.25rem;
        }
        .event-date {
            color: var(--muted);
            font-size: 0.9rem;
        }
        .event-years {
            color: var(--accent-soft);
            font-size: 0.85rem;
            font-weight: 600;
            margin-top: 0.25rem;
        }

        .calendar-day.highlighted {
            animation: pulse 1.5s ease-in-out 3;
        }

        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(205, 133, 63, 0.7); }
            50% { box-shadow: 0 0 0 10px rgba(205, 133, 63, 0); }
        }

        /* SEARCH RESULTS STYLING */
        .search-result-item {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .search-result-item:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-soft);
            background: rgba(205, 133, 63, 0.1);
        }
        .search-result-name {
            font-weight: 700;
            color: var(--fg);
            margin-bottom: 0.25rem;
        }
        .search-result-dates {
            font-size: 0.85rem;
            color: var(--muted);
        }
        .search-result-badge {
            background: rgba(205, 133, 63, 0.2);
            padding: 0.25rem 0.75rem;
            border-radius: 999px;
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--accent-strong);
        }

        @media (max-width: 768px) {
            .container {
                padding-left: 0.5rem;
                padding-right: 0.5rem;
            }
            
            .calendar-grid {
                gap: 3px;
                width: 100%;
                max-width: 100vw;
                overflow: visible;
            }
            
            .calendar-day {
                min-height: 60px;
                padding: 0.25rem;
            }
            .calendar-day-number {
                font-size: 0.9rem;
            }
            .calendar-day-header {
                font-size: 0.7rem;
                padding: 0.5rem 0.25rem;
            }
            .event-dot {
                width: 4px;
                height: 4px;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding-left: 0.15rem;
                padding-right: 0.15rem;
            }
            
            .calendar-grid {
                gap: 1px;
            }
            
            .calendar-day {
                min-height: 50px;
                padding: 0.2rem;
                border-radius: 8px;
            }
            
            .calendar-day-number {
                font-size: 0.85rem;
            }
            
            .calendar-day-header {
                font-size: 0.6rem;
                padding: 0.3rem 0;
            }
            
            .event-dot {
                width: 3px;
                height: 3px;
            }
            
            .search-result-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }
        }

        @media (max-width: 360px) {
            .container {
                padding-left: 0;
                padding-right: 0;
            }
            
            .calendar-grid {
                gap: 1px;
                padding: 0 0.1rem;
            }
            
            .calendar-day-number {
                font-size: 0.8rem;
            }
        }
    </style>
    <link rel="canonical" href="https://historyaddress.bg/calendar.html">
    <meta name="robots" content="index, follow">
</head>
<script>
function handleEmailClick(event) {
    // On mobile (screen width < 768px), let mailto work normally
    if (window.innerWidth <= 768) {
        return; // Don't prevent default, let mailto: work
    }
    
    // On desktop, show modal
    event.preventDefault();
    showEmailModal();
}

function showEmailModal() {
    var modal = document.getElementById('emailModal');
    if (!modal) {
        // Create modal if it doesn't exist
        modal = document.createElement('div');
        modal.id = 'emailModal';
        modal.className = 'email-modal';
        modal.innerHTML = `
            <div class="email-modal-content">
                <h3>üìß –°–≤—ä—Ä–∂–µ—Ç–µ —Å–µ —Å –Ω–∞—Å</h3>
                <div class="email-address-display" id="emailDisplay">historyaddressbg@gmail.com</div>
                <div class="email-modal-buttons">
                    <button class="btn-copy" onclick="copyEmail()">
                        <span id="copyText">üìã –ö–æ–ø–∏—Ä–∞–π Email</span>
                    </button>
                    <button class="btn-close" onclick="closeEmailModal()">‚úï –ó–∞—Ç–≤–æ—Ä–∏</button>
                </div>
                <p>–ú–æ–∂–µ—Ç–µ –¥–∞ –Ω–∏ –ø–∏—à–µ—Ç–µ –∑–∞ –≤—ä–ø—Ä–æ—Å–∏ –∏–ª–∏ –ø–æ–¥–∫—Ä–µ–ø–∞</p>
            </div>
        `;
        document.body.appendChild(modal);
        
        // Close on backdrop click
        modal.addEventListener('click', function(e) {
            if (e.target === modal) {
                closeEmailModal();
            }
        });
    }
    
    modal.style.display = 'flex';
    document.body.style.overflow = 'hidden';
}

function closeEmailModal() {
    var modal = document.getElementById('emailModal');
    if (modal) {
        modal.style.display = 'none';
        document.body.style.overflow = '';
    }
}

function copyEmail() {
    var email = 'historyaddressbg@gmail.com';
    navigator.clipboard.writeText(email).then(function() {
        var btn = document.querySelector('.btn-copy');
        var text = document.getElementById('copyText');
        
        btn.classList.add('copied');
        text.textContent = '‚úì –ö–æ–ø–∏—Ä–∞–Ω–æ!';
        
        setTimeout(function() {
            btn.classList.remove('copied');
            text.textContent = 'üìã –ö–æ–ø–∏—Ä–∞–π Email';
        }, 2000);
    }).catch(function(err) {
        alert('Email: ' + email);
    });
}

// Close modal on ESC key
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
        closeEmailModal();
    }
});
</script>
<body>
    <header class="site-header">
        <a class="logo-link" href="index.html">
            <img src="assets/img/HistAdrLogo.png" alt="–ê–¥—Ä–µ—Å—ä—Ç –Ω–∞ –∏—Å—Ç–æ—Ä–∏—è—Ç–∞" class="header-logo">
            <span class="logo-text">–ê–¥—Ä–µ—Å—ä—Ç –Ω–∞ –∏—Å—Ç–æ—Ä–∏—è—Ç–∞</span>
        </a>
        <nav class="nav">
            <a href="index.html">–ù–∞—á–∞–ª–æ</a>
            <a href="map.html">–ö–∞—Ä—Ç–∞</a>
            <a href="addresses.html">–î–æ–º–æ–≤–µ</a>
            <a href="calendar.html">–ö–∞–ª–µ–Ω–¥–∞—Ä</a>
            <a href="about.html">–ó–∞ –ù–∞—Å</a>
        </nav>
        <button id="theme-toggle" class="theme-toggle" aria-label="Toggle dark mode"></button>
    </header>

    <main class="container">
        <h1 class="page-title gradient-text">üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä –Ω–∞ —Å—ä–±–∏—Ç–∏—è—Ç–∞</h1>
        
        <div style="margin-bottom: 1.5rem;">
            <input 
                type="text" 
                id="searchInput" 
                class="input" 
                placeholder="üîç –¢—ä—Ä—Å–∏ –ø–æ –∏–º–µ –Ω–∞ –ª–∏—á–Ω–æ—Å—Ç..." 
                style="width: 100%; max-width: 500px; font-size: 1rem;"
            >
            <div id="searchResults" style="margin-top: 0.5rem;"></div>
        </div>
        
        <div class="calendar-header">
            <div class="calendar-nav">
                <button id="prevMonth" class="theme-toggle">‚óÄ</button>
                <span class="calendar-title" id="monthYear">Loading...</span>
                <button id="nextMonth" class="theme-toggle">‚ñ∂</button>
            </div>
            <button id="todayBtn" class="theme-toggle">–î–Ω–µ—Å</button>
        </div>

        <div class="calendar-grid" id="calendarGrid"></div>
        <div class="events-list" id="eventsList"></div>
    </main>

    <footer class="site-footer">
        <p>¬© <span id="year"></span> –ê–¥—Ä–µ—Å—ä—Ç –Ω–∞ –∏—Å—Ç–æ—Ä–∏—è—Ç–∞</p>
        <div class="footer-social">
            <a href="https://instagram.com/historyaddress.bg" target="_blank" rel="noopener noreferrer" class="social-link">üì∑ Instagram</a>
           <a href="mailto:historyaddressbg@gmail.com" class="social-link" onclick="handleEmailClick(event)">
    üìß Email
</a>
        </div>
        <p class="footer-links">
            <a href="privacy.html">–ü–æ–≤–µ—Ä–∏—Ç–µ–ª–Ω–æ—Å—Ç</a> | 
            <a href="terms.html">–£—Å–ª–æ–≤–∏—è</a> | 
            <a href="copyright.html">–ê–≤—Ç–æ—Ä—Å–∫–∏ –ø—Ä–∞–≤–∞</a>
        </p>
    </footer>

<script>
(function() {
    var apiBase = window.location.protocol === 'file:' ? 'http://localhost:3000' : window.location.origin;
    
    var savedState = null;
    try {
        var saved = sessionStorage.getItem('calendar-state');
        if (saved) savedState = JSON.parse(saved);
    } catch(e) {}
    
    var currentDate = savedState && savedState.month && savedState.year 
        ? new Date(savedState.year, savedState.month - 1, 1)
        : new Date();
    var selectedDate = savedState ? savedState.selectedDate : null;
    var eventsData = {};
    var allPeopleData = [];
    var searchTimeout;
    
    var monthNames = ['–Ø–Ω—É–∞—Ä–∏', '–§–µ–≤—Ä—É–∞—Ä–∏', '–ú–∞—Ä—Ç', '–ê–ø—Ä–∏–ª', '–ú–∞–π', '–Æ–Ω–∏', '–Æ–ª–∏', '–ê–≤–≥—É—Å—Ç', '–°–µ–ø—Ç–µ–º–≤—Ä–∏', '–û–∫—Ç–æ–º–≤—Ä–∏', '–ù–æ–µ–º–≤—Ä–∏', '–î–µ–∫–µ–º–≤—Ä–∏'];
    var dayNames = ['–ù–¥', '–ü–Ω', '–í—Ç', '–°—Ä', '–ß—Ç', '–ü—Ç', '–°–±'];
    
    function saveCalendarState() {
        try {
            sessionStorage.setItem('calendar-state', JSON.stringify({
                month: currentDate.getMonth() + 1,
                year: currentDate.getFullYear(),
                selectedDate: selectedDate
            }));
        } catch(e) {}
    }
    
    function loadAllPeople() {
        fetch(apiBase + '/api/calendar/all')
            .then(function(res) { return res.json(); })
            .then(function(data) { allPeopleData = data; })
            .catch(function(err) { console.error('Error loading people:', err); });
    }
    
    document.getElementById('searchInput').addEventListener('input', function(e) {
        clearTimeout(searchTimeout);
        var query = e.target.value.trim().toLowerCase();
        if (query.length < 2) {
            document.getElementById('searchResults').innerHTML = '';
            return;
        }
        searchTimeout = setTimeout(function() { performSearch(query); }, 300);
    });
    
    function performSearch(query) {
        var words = query.split(/\s+/);
        var results = allPeopleData.filter(function(person) {
            var nameLower = person.name.toLowerCase();
            return words.every(function(word) { return nameLower.includes(word); });
        });
        displaySearchResults(results.slice(0, 5));
    }
    
    function displaySearchResults(results) {
        var container = document.getElementById('searchResults');
        if (results.length === 0) {
            container.innerHTML = '<div style="color: var(--muted); font-size: 0.9rem;">–ù—è–º–∞ —Ä–µ–∑—É–ª—Ç–∞—Ç–∏</div>';
            return;
        }
        
        var html = '';
        results.forEach(function(person) {
            var dates = [];
            if (person.birth_date) dates.push('üéÇ ' + person.birth_date);
            if (person.death_date) dates.push('üïØÔ∏è ' + person.death_date);
            var datesText = dates.join(' ‚Ä¢ ');
            
            var count = (person.birth_date ? 1 : 0) + (person.death_date ? 1 : 0);
            var badge = count + ' ' + (count === 1 ? '–¥–∞—Ç–∞' : '–¥–∞—Ç–∏');
            
            html += '<div class="search-result-item" onclick="showPersonDates(\'' + (person.birth_date || '') + '\', \'' + (person.death_date || '') + '\', \'' + person.name.replace(/'/g, "\\'") + '\')">';
            html += '<div>';
            html += '<div class="search-result-name">' + person.name + '</div>';
            html += '<div class="search-result-dates">' + datesText + '</div>';
            html += '</div>';
            html += '<div class="search-result-badge">' + badge + '</div>';
            html += '</div>';
        });
        container.innerHTML = html;
    }

    window.showPersonDates = function(birthDate, deathDate, personName) {
        var container = document.getElementById('searchResults');
        var html = '<div style="background: var(--card); border: 2px solid var(--accent-strong); border-radius: 12px; padding: 1rem; margin-bottom: 0.5rem;">';
        html += '<div style="font-weight: 700; margin-bottom: 0.75rem; font-size: 1.1rem;">' + personName + '</div>';
        
        if (birthDate) {
            html += '<div class="search-result-item" style="margin-bottom: 0.5rem;" onclick="jumpToDate(\'' + birthDate + '\', \'' + personName.replace(/'/g, "\\'") + '\')">';
            html += '<div><div class="search-result-name">üéÇ –†–æ–∂–¥–µ–Ω –¥–µ–Ω</div>';
            html += '<div class="search-result-dates">' + birthDate + '</div></div>';
            html += '<div class="search-result-badge">–í–∏–∂</div></div>';
        }
        
        if (deathDate) {
            html += '<div class="search-result-item" style="margin-bottom: 0;" onclick="jumpToDate(\'' + deathDate + '\', \'' + personName.replace(/'/g, "\\'") + '\')">';
            html += '<div><div class="search-result-name">üïØÔ∏è –î–∞—Ç–∞ –Ω–∞ —Å–º—ä—Ä—Ç</div>';
            html += '<div class="search-result-dates">' + deathDate + '</div></div>';
            html += '<div class="search-result-badge">–í–∏–∂</div></div>';
        }
        
        html += '<button onclick="performSearch(document.getElementById(\'searchInput\').value)" style="margin-top: 0.75rem; padding: 0.5rem 1rem; background: var(--muted); border: none; border-radius: 8px; cursor: pointer; width: 100%; color: var(--fg); font-weight: 600;">‚Üê –ù–∞–∑–∞–¥ –∫—ä–º —Ä–µ–∑—É–ª—Ç–∞—Ç–∏—Ç–µ</button>';
        html += '</div>';
        
        container.innerHTML = html;
    }
    
    window.jumpToDate = function(dateStr, personName) {
        var date = new Date(dateStr);
        currentDate = new Date(date.getFullYear(), date.getMonth(), 1);
        saveCalendarState();
        loadEvents();
        
        document.getElementById('searchInput').value = '';
        document.getElementById('searchResults').innerHTML = '';
        
        setTimeout(function() {
            var dateKey = String(date.getMonth() + 1).padStart(2, '0') + '-' + String(date.getDate()).padStart(2, '0');
            selectedDate = dateKey;
            saveCalendarState();
            showEventsForDate(dateKey);
            highlightDay(date.getDate());
            
            setTimeout(function() {
                document.getElementById('eventsList').scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 100);
        }, 200);
    }
    
    function highlightDay(day) {
        var cells = document.querySelectorAll('.calendar-day');
        cells.forEach(function(cell) {
            var num = cell.querySelector('.calendar-day-number');
            if (num && parseInt(num.textContent) === day && !cell.classList.contains('other-month')) {
                cell.classList.add('highlighted');
                setTimeout(function() { cell.classList.remove('highlighted'); }, 4500);
            }
        });
    }
    
    function loadEvents() {
        var month = currentDate.getMonth() + 1;
        var year = currentDate.getFullYear();
        saveCalendarState();
        fetch(apiBase + '/api/calendar?month=' + month + '&year=' + year)
            .then(function(res) { return res.json(); })
            .then(function(data) {
                eventsData = data;
                renderCalendar();
                if (selectedDate) showEventsForDate(selectedDate);
            });
    }
    
    function renderCalendar() {
        var grid = document.getElementById('calendarGrid');
        grid.innerHTML = '';
        dayNames.forEach(function(day) {
            var header = document.createElement('div');
            header.className = 'calendar-day-header';
            header.textContent = day;
            grid.appendChild(header);
        });
        
        var year = currentDate.getFullYear();
        var month = currentDate.getMonth();
        var firstDay = new Date(year, month, 1).getDay();
        var daysInMonth = new Date(year, month + 1, 0).getDate();
        var daysInPrevMonth = new Date(year, month, 0).getDate();
        
        for (var i = firstDay - 1; i >= 0; i--) grid.appendChild(createDayCell(daysInPrevMonth - i, true, false));
        for (var day = 1; day <= daysInMonth; day++) {
            var today = new Date();
            var isToday = today.getMonth() === month && today.getFullYear() === year && day === today.getDate();
            grid.appendChild(createDayCell(day, false, isToday));
        }
        var totalCells = grid.children.length - 7;
        var remainingCells = (Math.ceil(totalCells / 7) * 7) - totalCells;
        for (var day = 1; day <= remainingCells; day++) grid.appendChild(createDayCell(day, true, false));
        document.getElementById('monthYear').textContent = monthNames[month] + ' ' + year;
    }
    
    function createDayCell(day, otherMonth, isToday) {
        var cell = document.createElement('div');
        cell.className = 'calendar-day' + (otherMonth ? ' other-month' : '') + (isToday ? ' today' : '');
        var dateKey = String(currentDate.getMonth() + (otherMonth ? (day > 15 ? 0 : 2) : 1)).padStart(2, '0') + '-' + String(day).padStart(2, '0');
        var events = eventsData[dateKey] || [];
        if (events.length > 0 && !otherMonth) {
            cell.className += ' has-events';
            cell.onclick = function() { selectedDate = dateKey; saveCalendarState(); showEventsForDate(dateKey); };
        }
        var number = document.createElement('div');
        number.className = 'calendar-day-number';
        number.textContent = day;
        cell.appendChild(number);
        if (events.length > 0) {
            var indicator = document.createElement('div');
            indicator.className = 'calendar-events-indicator';
            events.forEach(function(event) {
                var dot = document.createElement('div');
                dot.className = 'event-dot ' + event.type;
                indicator.appendChild(dot);
            });
            cell.appendChild(indicator);
        }
        return cell;
    }
    
    function showEventsForDate(dateKey) {
        var events = eventsData[dateKey] || [];
        var listEl = document.getElementById('eventsList');
        if (events.length === 0) { listEl.innerHTML = ''; return; }
        var parts = dateKey.split('-');
        var html = '<h2 style="margin-bottom: 1rem; color: var(--fg);">–°—ä–±–∏—Ç–∏—è –Ω–∞ ' + parts[1] + ' ' + monthNames[parseInt(parts[0]) - 1] + '</h2>';
        events.forEach(function(event) {
            html += '<a href="address.html?slug=' + encodeURIComponent(event.slug) + '" class="event-card">';
            html += '<div class="event-icon">' + (event.type === 'birth' ? 'üéÇ' : 'üïØÔ∏è') + '</div>';
            html += '<div class="event-content"><div class="event-name">' + event.name + '</div>';
            html += '<div class="event-date">' + (event.type === 'birth' ? '–†–æ–¥–µ–Ω' : '–ü–æ—á–∏–Ω–∞–ª') + ' –Ω–∞ ' + event.full_date + '</div>';
            html += '<div class="event-years">–ü—Ä–µ–¥–∏ ' + event.years_ago + ' ' + (event.years_ago === 1 ? '–≥–æ–¥–∏–Ω–∞' : '–≥–æ–¥–∏–Ω–∏') + '</div></div></a>';
        });
        listEl.innerHTML = html;
        listEl.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }
    
    document.getElementById('prevMonth').addEventListener('click', function() { currentDate.setMonth(currentDate.getMonth() - 1); selectedDate = null; document.getElementById('eventsList').innerHTML = ''; saveCalendarState(); loadEvents(); });
    document.getElementById('nextMonth').addEventListener('click', function() { currentDate.setMonth(currentDate.getMonth() + 1); selectedDate = null; document.getElementById('eventsList').innerHTML = ''; saveCalendarState(); loadEvents(); });
    document.getElementById('todayBtn').addEventListener('click', function() { currentDate = new Date(); selectedDate = null; document.getElementById('eventsList').innerHTML = ''; saveCalendarState(); loadEvents(); });
    
    document.getElementById('year').textContent = new Date().getFullYear();
    loadEvents();
    loadAllPeople();
})();
</script>
</body>
</html>
